<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Massagem, Massoterapia, Shiatsu, Quick Massage - Espaço VIV</title>
    <meta name="description" content="ABERTO 24H Com diversas promoções para você! PROFISSIONAIS CERTIFICADOS Nossas massagistas e terapeutas são treinadas e certificadas QUICK MASSAGE PARA EMPRESAS Aumente a produtividade da sua empresa">
    
    <!-- Favicon -->
    <link rel="shortcut icon" href="https://espacoviv.com/wp-content/uploads/2018/09/icon-16.png" type="image/x-icon" />
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <!-- CSS Essenciais -->
    <link rel="stylesheet" href="https://espacoviv.com/wp-content/plugins/elementor/assets/css/frontend.min.css?ver=3.30.2">
    <link rel="stylesheet" href="https://espacoviv.com/wp-content/plugins/elementor/assets/lib/swiper/v8/css/swiper.min.css?ver=8.4.5">
    <link rel="stylesheet" href="https://espacoviv.com/wp-content/plugins/elementor-pro/assets/css/widget-slides.min.css?ver=3.29.2">
    <link rel="stylesheet" href="https://espacoviv.com/wp-content/plugins/elementor/assets/lib/font-awesome/css/font-awesome.min.css?ver=4.7.0">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Roboto+Slab:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* Estilos customizados */
        body {
            margin: 0;
            font-family: 'Roboto', Arial, sans-serif;
        }
        
        .fusion-header-wrapper {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 99999;
        }
        
        .fusion-header {
            background: #47103C;
            color: white;
            padding: 10px 0;
        }
        
        .fusion-header-v2 {
            background: white;
            border-bottom: 1px solid #eee;
            padding: 0;
        }
        
        .fusion-row {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .fusion-contact-info {
            font-size: 13px;
        }
        
        .fusion-contact-info a {
            color: white;
            text-decoration: none;
        }
        
        .fusion-social-links-header a {
            color: white;
            margin-left: 10px;
            font-size: 16px;
        }
        
        .fusion-logo {
            padding: 15px 0;
        }
        
        .fusion-main-menu ul {
            list-style: none;
            display: flex;
            margin: 0;
            padding: 0;
            gap: 30px;
        }
        
        .fusion-main-menu a {
            color: #333;
            text-decoration: none;
            padding: 20px 0;
            font-weight: 500;
            position: relative;
            transition: color 0.3s;
        }
        
        .fusion-main-menu a:hover {
            color: #47103C;
        }
        
        .fusion-main-menu .current-menu-item a {
            color: #47103C;
            border-bottom: 3px solid #47103C;
        }
        
        .login-massagistas-btn {
            background: #47103C;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
        }
        
        .login-massagistas-btn:hover {
            background: #3c0d32;
        }
        
        /* Menu do Usuário */
        .user-menu {
            position: relative;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-info-header {
            background: #47103C;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            font-weight: 500;
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 1000;
        }
        
        .user-info-header:hover {
            background: #3c0d32;
        }
        
        .user-info-header i {
            font-size: 16px;
        }
        
        #userName {
            font-weight: 600;
        }
        
        #userLocation {
            opacity: 0.8;
            font-size: 11px;
        }
        
        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            min-width: 200px;
            z-index: 1000;
            display: none;
            border: 1px solid #e0e0e0;
            margin-top: 5px;
        }
        
        .user-dropdown.show {
            display: block;
        }
        
        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 15px;
            color: #333;
            text-decoration: none;
            font-size: 14px;
            transition: background 0.2s;
        }
        
        .dropdown-item:hover {
            background: #f8f9fa;
            color: #47103C;
        }
        
        .dropdown-item i {
            width: 16px;
            color: #666;
        }
        
        /* Hero Section */
        .hero-section {
            margin-top: 120px;
            height: 600px;
            position: relative;
        }
        
        .swiper {
            height: 100%;
        }
        
        .swiper-slide {
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .slide-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.4);
        }
        
        .slide-content {
            position: relative;
            z-index: 2;
            text-align: center;
            color: white;
            max-width: 800px;
            padding: 0 20px;
        }
        
        .slide-content h1 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .slide-content p {
            font-size: 1.4rem;
            margin-bottom: 30px;
            opacity: 0.95;
        }
        
        .slide-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
            text-decoration: none;
            display: inline-block;
        }
        
        .slide-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            color: white;
        }
        
        /* Seção Ganhe Massagem */
        .ganhe-massagem-section {
            background: white;
            padding: 80px 0;
            text-align: center;
        }
        
        .section-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .ganhe-massagem-section h2 {
            color: #47103C;
            font-size: 2.5rem;
            margin-bottom: 20px;
            font-family: 'Roboto Slab', serif;
        }
        
        .ganhe-massagem-section p {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 40px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .quero-massagem-btn {
            background: #47103C;
            color: white;
            border: 2px solid #47103C;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }
        
        .quero-massagem-btn:hover {
            background: transparent;
            color: #47103C;
        }
        
        /* Continue Button Styles */
        .continue-btn {
            width: 100%;
            margin-top: 20px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(71, 16, 60, 0.3);
        }
        
        .continue-btn:hover {
            background: linear-gradient(135deg, #47103C 0%, #5d1a4a 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(71, 16, 60, 0.4);
        }
        
        .continue-btn:active {
            transform: translateY(0);
            box-shadow: 0 4px 15px rgba(71, 16, 60, 0.3);
        }
        
        .continue-btn .fas {
            transition: transform 0.3s ease;
        }
        
        .continue-btn:hover .fas {
            transform: translateX(3px);
        }
        
        /* Footer */
        .fusion-footer-widget-area {
            background: #333;
            color: white;
            padding: 60px 0 20px;
        }
        
        .footer-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .fusion-footer-widget-column h4 {
            color: white;
            margin-bottom: 20px;
        }
        
        .fusion-footer-widget-column a {
            color: #ccc;
            text-decoration: none;
        }
        
        .fusion-footer-widget-column a:hover {
            color: white;
        }
        
        .fusion-footer-copyright-area {
            border-top: 1px solid #555;
            padding: 20px 0;
            text-align: center;
            color: #ccc;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 100000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
        }
        
        .modal-content {
            background: white;
            margin: 3% auto;
            padding: 30px;
            border-radius: 10px;
            max-width: 500px;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-close {
            position: absolute;
            right: 15px;
            top: 10px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #999;
        }
        
        .modal-close:hover {
            color: #333;
        }
        
        /* Booking Steps Styling */
        .booking-step {
            border: 2px solid #f0f0f0;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            background: #fafafa;
            transition: all 0.3s ease;
        }
        
        .booking-step.active {
            border-color: #47103C;
            background: white;
            box-shadow: 0 4px 15px rgba(71, 16, 60, 0.1);
        }
        
        /* Massagista Grid */
        .massagista-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .massagista-card {
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }
        
        .massagista-card:hover {
            border-color: #47103C;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(71, 16, 60, 0.15);
        }
        
        .massagista-card.selected {
            border-color: #47103C;
            background: #47103C;
            color: white;
        }
        
        .massagista-card img, .avatar-placeholder {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 10px;
            border: 3px solid #f0f0f0;
        }
        
        .avatar-placeholder {
            background: #47103C;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
        }
        
        .massagista-card.selected img, .massagista-card.selected .avatar-placeholder {
            border-color: white;
        }
        
        .massagista-card h4 {
            margin: 5px 0;
            font-size: 16px;
            font-weight: 600;
        }
        
        .massagista-card p {
            margin: 0;
            font-size: 12px;
            opacity: 0.8;
        }
        
        /* Smart Calendar */
        .smart-calendar {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }
        
        .calendar-section {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
        }
        
        .calendar-grid {
            margin-top: 15px;
        }
        
        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            margin-bottom: 10px;
        }
        
        .weekday {
            padding: 8px;
            text-align: center;
            font-weight: 600;
            color: #47103C;
            background: #f8f9fa;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        
        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
        }
        
        .calendar-dates {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-top: 10px;
        }
        
        .calendar-day {
            padding: 8px;
            text-align: center;
            border: 1px solid #f0f0f0;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.2s ease;
        }
        
        .calendar-day:hover {
            background: #f8f9fa;
        }
        
        .calendar-day.available {
            background: #e8f5e8;
            border-color: #4caf50;
            color: #2e7d32;
        }
        
        .calendar-day.selected {
            background: #47103C;
            color: white;
            border-color: #47103C;
        }
        
        .calendar-day.unavailable {
            background: #ffebee;
            color: #c62828;
            border-color: #f44336;
            cursor: not-allowed;
        }
        
        .calendar-day.past {
            background: #f5f5f5;
            color: #9e9e9e;
            border-color: #e0e0e0;
            cursor: not-allowed;
        }
        
        .calendar-day.empty {
            border: none;
            cursor: default;
        }
        
        .calendar-day.empty:hover {
            background: transparent;
        }
        
        .time-slots {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-top: 10px;
        }
        
        .time-slot {
            padding: 8px 12px;
            text-align: center;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
        }
        
        .time-slot:hover {
            background: #f8f9fa;
        }
        
        .time-slot.available {
            background: #e8f5e8;
            border-color: #4caf50;
            color: #2e7d32;
        }
        
        .time-slot.selected {
            background: #47103C;
            color: white;
            border-color: #47103C;
        }
        
        .time-slot.unavailable {
            background: #ffebee;
            color: #c62828;
            border-color: #f44336;
            cursor: not-allowed;
        }
        
        /* Progress Indicators */
        .booking-progress {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 0 20px;
        }
        
        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            position: relative;
        }
        
        .progress-step::after {
            content: '';
            position: absolute;
            top: 20px;
            left: 50%;
            width: 100%;
            height: 2px;
            background: #e0e0e0;
            z-index: 1;
        }
        
        .progress-step:last-child::after {
            display: none;
        }
        
        .progress-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #999;
            z-index: 2;
            position: relative;
        }
        
        .progress-step.active .progress-circle {
            background: #47103C;
            color: white;
        }
        
        .progress-step.completed .progress-circle {
            background: #4caf50;
            color: white;
        }
        
        .progress-step.completed::after {
            background: #4caf50;
        }
        
        .progress-label {
            font-size: 12px;
            margin-top: 8px;
            text-align: center;
            font-weight: 500;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .form-row .form-group {
            margin-bottom: 0;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            box-sizing: border-box;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: #47103C;
            outline: none;
        }
        
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 8px;
        }
        
        .specialty-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }
        
        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }
        
        .price-input {
            padding: 8px;
            border: 2px solid #47103C;
            border-radius: 5px;
            font-size: 14px;
            background: #f9f9f9;
        }
        
        .price-input:focus {
            outline: none;
            background: white;
            border-color: #65217A;
            font-weight: normal;
            margin-bottom: 5px;
            cursor: pointer;
        }
        
        .checkbox-label input[type="checkbox"] {
            width: auto;
            margin: 0;
        }
        
        .btn-loading {
            display: none;
        }
        
        /* Seções de Unidades e Massagens */
        .unidades-section,
        .massagens-section {
            padding: 80px 0;
            background: #f8f9fa;
        }

        .unidades-section:nth-child(even),
        .massagens-section:nth-child(even) {
            background: white;
        }

        .unidades-grid,
        .massagens-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px;
            margin-top: 50px;
        }

        .unidade-card,
        .massagem-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
        }

        .unidades-section .unidade-card,
        .unidades-section .massagem-card {
            background: #f8f9fa;
        }

        .unidade-card:hover,
        .massagem-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(71, 16, 60, 0.2);
        }

        .elementor-image-box-img {
            position: relative;
            overflow: hidden;
        }

        .elementor-image-box-img img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .elementor-image-box-wrapper:hover .elementor-image-box-img img {
            transform: scale(1.1);
        }

        .elementor-image-box-content {
            padding: 30px 25px;
        }

        .elementor-image-box-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #47103C;
            margin-bottom: 15px;
            font-family: 'Roboto Slab', serif;
        }

        .elementor-image-box-title a {
            color: inherit;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .elementor-image-box-title a:hover {
            color: #5d1a4a;
        }

        .elementor-text-editor p {
            color: #666;
            line-height: 1.7;
            font-size: 1rem;
        }

        /* Detalhes das Unidades */
        .unidades-detalhes {
            max-height: 300px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .unidade-item {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .unidade-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .unidade-item h4 {
            color: #47103C;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .unidade-item p {
            margin-bottom: 5px;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .contatos {
            margin-top: 8px;
        }

        .contatos p {
            display: inline-block;
            margin-right: 15px;
            margin-bottom: 3px;
            font-size: 0.85rem;
            color: #47103C;
            font-weight: 500;
        }

        /* Banner Valéria Baccari */
        .valeria-banner {
            padding: 40px 0;
            text-align: center;
            background: #f8f9fa;
        }

        .banner-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .valeria-banner img {
            width: 100%;
            max-width: 800px;
            height: auto;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .fusion-main-menu {
                display: none;
            }
            
            .slide-content h1 {
                font-size: 2.5rem;
            }
            
            .slide-content p {
                font-size: 1.2rem;
            }
            
            .hero-section {
                height: 400px;
            }
            
            .smart-calendar {
                grid-template-columns: 1fr;
            }
            
            .massagista-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
            
            .time-slots {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .booking-progress {
                padding: 0 10px;
            }
            
            .progress-label {
                font-size: 10px;
            }
            
            .modal-content {
                margin: 2% auto;
                padding: 20px;
                max-width: 95%;
            }
            
            .form-row {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .modal-content h2 {
                font-size: 1.5rem;
                margin-bottom: 20px;
            }

            .unidades-section,
            .massagens-section {
                padding: 50px 0;
            }

            .unidades-grid,
            .massagens-grid {
                grid-template-columns: 1fr;
                gap: 30px;
                margin-top: 30px;
            }

            .elementor-image-box-content {
                padding: 20px;
            }

            .elementor-image-box-title {
                font-size: 1.5rem;
            }


            .valeria-banner {
                padding: 20px 0;
            }

            .unidades-detalhes {
                max-height: none;
                overflow-y: visible;
            }

            .unidade-item h4 {
                font-size: 1rem;
            }

            .unidade-item p {
                font-size: 0.85rem;
            }

            .contatos p {
                display: block;
                margin-right: 0;
                margin-bottom: 5px;
            }
        }

        /* Swiper Navigation Buttons */
        .swiper-button-next,
        .swiper-button-prev {
            color: #47103C !important;
        }

        .swiper-button-next:after,
        .swiper-button-prev:after {
            font-weight: 900 !important;
        }
    </style>
</head>
<body class="home">
    
    <!-- Header -->
    <div class="fusion-header-wrapper">
        <!-- Top Header -->
        <div class="fusion-header">
            <div class="fusion-row">
                <div class="fusion-alignleft">
                    <div class="fusion-contact-info">
                        <span>(11) 93387-6643 / (11) 3082-3652</span>
                        <span class="fusion-header-separator">|</span>
                        <span><a href="mailto:contato@espacoviv.com">contato@espacoviv.com</a> / <a href="mailto:rh.espacoviv@gmail.com">rh.espacoviv@gmail.com</a></span>
                    </div>
                </div>
                <div class="fusion-alignright">
                    <div class="fusion-social-links-header">
                        <a href="http://facebook.com/espacovivrj/" target="_blank"><i class="fab fa-facebook-f"></i></a>
                        <a href="http://instagram.com/espacovivrj/" target="_blank"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Main Header -->
        <div class="fusion-header-v2">
            <div class="fusion-row">
                <div class="fusion-logo">
                    <a href="#home">
                        <img src="https://espacoviv.com/wp-content/uploads/2019/06/logo-espaco-viv-rj.png" alt="Espaço VIV Logo" width="184" height="73" />
                    </a>
                </div>
                
                <nav class="fusion-main-menu">
                    <ul>
                        <li class="current-menu-item"><a href="#home">Início</a></li>
                        <li><a href="#unidades">Unidades</a></li>
                        <li><a href="massagens.html">Massagens</a></li>
                        <li><a href="promocoes.html">Promoções</a></li>
                        <li><a href="cursos.html">Cursos</a></li>
                    </ul>
                </nav>
                
                <!-- Botão de Login (quando não logado) -->
                <button id="loginBtn" class="login-massagistas-btn">
                    <i class="fas fa-user"></i> Login Massagistas
                </button>
                
                <!-- Menu do Usuário (quando logado) -->
                <div id="userMenu" class="user-menu" style="display: none;">
                    <div class="user-info-header">
                        <i class="fas fa-user-circle"></i>
                        <span id="userName">MATHEUS VITORINO RIBEIRO</span>
                        <span id="userLocation">Brasília - SHS</span>
                    </div>
                    <div class="user-dropdown">
                        <a href="dashboard.html" class="dropdown-item">
                            <i class="fas fa-calendar-alt"></i> Meus Agendamentos
                        </a>
                        <a href="profile.html" class="dropdown-item">
                            <i class="fas fa-user-cog"></i> Meu Perfil
                        </a>
                        <a href="#" id="logoutBtn" class="dropdown-item">
                            <i class="fas fa-sign-out-alt"></i> Sair
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hero Slider -->
    <section id="home" class="hero-section">
        <div class="swiper heroSwiper">
            <div class="swiper-wrapper">
                <!-- Slide 1: ABERTO 24H -->
                <div class="swiper-slide" style="background-image: url('https://images.unsplash.com/photo-1544161515-4ab6ce6db874?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80');">
                    <div class="slide-overlay"></div>
                    <div class="slide-content">
                        <h1>ABERTO 24H</h1>
                        <p>Com diversas promoções para você!</p>
                        <a href="promocoes.html" class="slide-btn">Ver Promoções</a>
                    </div>
                </div>
                
                <!-- Slide 2: PROFISSIONAIS CERTIFICADOS -->
                <div class="swiper-slide" style="background-image: url('https://images.unsplash.com/photo-1515377905703-c4788e51af15?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80');">
                    <div class="slide-overlay"></div>
                    <div class="slide-content">
                        <h1>PROFISSIONAIS CERTIFICADOS</h1>
                        <p>Nossas massagistas e terapeutas são treinadas e certificadas</p>
                        <a href="#equipe" class="slide-btn">Conhecer Equipe</a>
                    </div>
                </div>
                
                <!-- Slide 3: QUICK MASSAGE PARA EMPRESAS -->
                <div class="swiper-slide" style="background-image: url('https://images.unsplash.com/photo-1540555700478-4be289fbecef?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80');">
                    <div class="slide-overlay"></div>
                    <div class="slide-content">
                        <h1>QUICK MASSAGE PARA EMPRESAS</h1>
                        <p>Aumente a produtividade da sua empresa</p>
                        <a href="massagens.html" class="slide-btn">Saiba Mais</a>
                    </div>
                </div>
            </div>
            
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
        </div>
    </section>

    <!-- Seção Nossas Unidades -->
    <section id="unidades" class="unidades-section">
        <div class="section-container">
            <h2 class="elementor-heading-title elementor-size-default">Nossas Unidades</h2>
            <div class="unidades-grid">
                <div class="unidade-card">
                    <div class="elementor-image-box-wrapper">
                        <div class="elementor-image-box-img">
                            <img src="../assets/images/sao-paulo-nova.jpg" alt="São Paulo">
                        </div>
                        <div class="elementor-image-box-content">
                            <h3 class="elementor-image-box-title">
                                <a href="unidades/sp.html">São Paulo</a>
                            </h3>
                            <div class="elementor-text-editor">
                                <p>4 Unidades em São Paulo:<br>
                                • Ingleses [Matriz] - Bela Vista<br>
                                • Perdizes - Aberto 24h<br>
                                • Vila Clementino - Aberto 24h<br>
                                • Prudente de Moraes - Aberto 24h</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="unidade-card">
                    <div class="elementor-image-box-wrapper">
                        <div class="elementor-image-box-img">
                            <img src="https://images.unsplash.com/photo-1483729558449-99ef09a8c325?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80" alt="Rio de Janeiro - Centro">
                        </div>
                        <div class="elementor-image-box-content">
                            <h3 class="elementor-image-box-title">
                                <a href="unidades/rj.html">Rio de Janeiro</a>
                            </h3>
                            <div class="elementor-text-editor">
                                <p>2 Unidades no Rio de Janeiro:<br>
                                • Centro - Aberto 24h<br>
                                • Copacabana - Aberto 24h</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="unidade-card">
                    <div class="elementor-image-box-wrapper">
                        <div class="elementor-image-box-img">
                            <img src="../assets/images/brasilia-nova.jpg" alt="Brasília - SHS">
                        </div>
                        <div class="elementor-image-box-content">
                            <h3 class="elementor-image-box-title">
                                <a href="unidades/bsb.html">Brasília</a>
                            </h3>
                            <div class="elementor-text-editor">
                                <p>2 Unidades em Brasília:<br>
                                • Sudoeste - Aberto 24h<br>
                                • Asa Sul - Galeria Hotel Nacional</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Seção Nossos Tratamentos -->
    <section id="massagens" class="massagens-section">
        <div class="section-container">
            <h2 class="elementor-heading-title elementor-size-default">Nossos Tratamentos</h2>
            <div class="massagens-grid">
                <div class="massagem-card">
                    <div class="elementor-image-box-wrapper">
                        <div class="elementor-image-box-img">
                            <img src="../../assets/images/shiatsu.png" alt="Shiatsu">
                        </div>
                        <div class="elementor-image-box-content">
                            <h3 class="elementor-image-box-title">
                                <a href="#shiatsu">Shiatsu</a>
                            </h3>
                            <div class="elementor-text-editor">
                                <p>Técnica japonesa que utiliza pressão com os dedos em pontos específicos do corpo para equilibrar a energia vital e promover relaxamento profundo.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="massagem-card">
                    <div class="elementor-image-box-wrapper">
                        <div class="elementor-image-box-img">
                            <img src="../../assets/images/quick-massage.jpg" alt="Quick Massage">
                        </div>
                        <div class="elementor-image-box-content">
                            <h3 class="elementor-image-box-title">
                                <a href="#quick">Quick Massage</a>
                            </h3>
                            <div class="elementor-text-editor">
                                <p>Massagem expressa de 15 a 30 minutos focada em aliviar tensões do pescoço, ombros e costas. Ideal para o dia a dia corrido.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="massagem-card">
                    <div class="elementor-image-box-wrapper">
                        <div class="elementor-image-box-img">
                            <img src="../../assets/images/swedish-massage.jpg" alt="Massagem Relaxante">
                        </div>
                        <div class="elementor-image-box-content">
                            <h3 class="elementor-image-box-title">
                                <a href="#relaxante">Relaxante</a>
                            </h3>
                            <div class="elementor-text-editor">
                                <p>Massagem suave e envolvente que promove relaxamento completo, alivia o estresse e melhora a circulação sanguínea.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
    </section>

    <!-- Banner Valéria Baccari -->
    <section class="valeria-banner">
        <div class="banner-container">
            <img src="../../assets/images/valweria.jpg" alt="Valéria Baccari - Fisioterapia">
        </div>
    </section>

    <!-- Seção Ganhe uma Quick Massage -->
    <section class="ganhe-massagem-section">
        <div class="section-container">
            <h2>GANHE UMA QUICK MASSAGE</h2>
            <p>Preencha seus dados e nos envie, você ganhará uma quick massage para ser utilizada em sua primeira visita a uma de nossas unidades.</p>
            <a href="#" id="agendarBtn" class="quero-massagem-btn">QUERO MINHA MASSAGEM</a>
        </div>
    </section>

    <!-- Footer -->
    <footer class="fusion-footer-widget-area">
        <div class="footer-row">
            <div class="fusion-footer-widget-column">
                <h4>Unidades</h4>
                <ul style="list-style: none; padding: 0;">
                    <li><a href="unidades/bsb.html">Brasília</a></li>
                    <li><a href="unidades/rj.html">Rio de Janeiro</a></li>
                    <li><a href="unidades/sp.html">São Paulo</a></li>
                </ul>
            </div>
            
            <div class="fusion-footer-widget-column">
                <h4>Pagamento</h4>
                <img src="https://espacoviv.com/wp-content/uploads/2023/06/visa-master.png" alt="Cartões aceitos" style="max-width: 150px;">
            </div>
            
            <div class="fusion-footer-widget-column">
                <h4>E-mail</h4>
                <p>contato@espacoviv.com</p>
                <p>rh.espacoviv@gmail.com</p>
            </div>
        </div>
        
        <div class="fusion-footer-copyright-area">
            <div class="fusion-row">
                <p>&copy; 2024 Espaço VIV. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Modal Login -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            
            <!-- Formulário de Login -->
            <div id="loginFormDiv">
                <h2>Login - Massagistas</h2>
                <form id="loginForm">
                    <div class="form-group">
                        <label>E-mail:</label>
                        <input type="email" id="loginEmail" required>
                    </div>
                    <div class="form-group">
                        <label>Senha:</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <div class="form-group">
                        <button type="submit" class="quero-massagem-btn" style="width: 100%;">
                            <span class="btn-text">Entrar</span>
                            <span class="btn-loading" style="display: none;">Entrando...</span>
                        </button>
                    </div>
                    <p style="text-align: center; margin-top: 20px;">
                        <a href="#" id="showForgotPassword" style="color: #47103C;">Esqueci minha senha</a> | 
                        <a href="#" id="showRegisterForm" style="color: #47103C;">Cadastre-se</a>
                    </p>
                </form>
            </div>

            <!-- Formulário de Cadastro -->
            <div id="registerFormDiv" style="display: none;">
                <h2>Cadastro - Massagistas</h2>
                <form id="registerForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Nome Completo:</label>
                            <input type="text" id="registerName" required>
                        </div>
                        <div class="form-group">
                            <label>CPF:</label>
                            <input type="text" id="registerCpf" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>E-mail:</label>
                            <input type="email" id="registerEmail" required>
                        </div>
                        <div class="form-group">
                            <label>Telefone:</label>
                            <input type="tel" id="registerPhone" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Senha:</label>
                            <input type="password" id="registerPassword" required minlength="6">
                        </div>
                        <div class="form-group">
                            <label>Confirmar Senha:</label>
                            <input type="password" id="confirmPassword" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Unidade de Trabalho:</label>
                        <select id="registerUnit" required>
                            <option value="">Selecione uma unidade</option>
                            <optgroup label="São Paulo (4 unidades)">
                                <option value="sp-ingleses">São Paulo - Ingleses [Matriz] - Bela Vista</option>
                                <option value="sp-perdizes">São Paulo - Perdizes</option>
                                <option value="sp-vila-clementino">São Paulo - Vila Clementino</option>
                                <option value="sp-prudente">São Paulo - Prudente de Moraes</option>
                            </optgroup>
                            <optgroup label="Rio de Janeiro (2 unidades)">
                                <option value="rj-centro">Rio de Janeiro - Centro</option>
                                <option value="rj-copacabana">Rio de Janeiro - Copacabana</option>
                            </optgroup>
                            <optgroup label="Brasília (2 unidades)">
                                <option value="bsb-sudoeste">Brasília - Sudoeste</option>
                                <option value="bsb-asa-sul">Brasília - Asa Sul - Galeria Hotel Nacional</option>
                            </optgroup>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Especialidades e Preços:</label>
                        <div id="specialtiesContainer" class="checkbox-group">
                            <div class="specialty-item">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="specialties" value="shiatsu" onchange="togglePriceInput(this)"> Shiatsu
                                </label>
                                <input type="number" class="price-input" name="price_shiatsu" placeholder="Preço R$" min="1" max="5000" step="0.01" style="display: none;">
                            </div>
                            <div class="specialty-item">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="specialties" value="quick" onchange="togglePriceInput(this)"> Quick Massage
                                </label>
                                <input type="number" class="price-input" name="price_quick" placeholder="Preço R$" min="1" max="5000" step="0.01" style="display: none;">
                            </div>
                            <div class="specialty-item">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="specialties" value="relaxante" onchange="togglePriceInput(this)"> Massagem Relaxante
                                </label>
                                <input type="number" class="price-input" name="price_relaxante" placeholder="Preço R$" min="1" max="5000" step="0.01" style="display: none;">
                            </div>
                            <div class="specialty-item">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="specialties" value="ventosaterapia" onchange="togglePriceInput(this)"> Ventosaterapia
                                </label>
                                <input type="number" class="price-input" name="price_ventosaterapia" placeholder="Preço R$" min="1" max="5000" step="0.01" style="display: none;">
                            </div>
                            <div class="specialty-item">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="specialties" value="drenagem" onchange="togglePriceInput(this)"> Drenagem Linfática
                                </label>
                                <input type="number" class="price-input" name="price_drenagem" placeholder="Preço R$" min="1" max="5000" step="0.01" style="display: none;">
                            </div>
                            <div class="specialty-item">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="specialties" value="redutora" onchange="togglePriceInput(this)"> Massagem Redutora
                                </label>
                                <input type="number" class="price-input" name="price_redutora" placeholder="Preço R$" min="1" max="5000" step="0.01" style="display: none;">
                            </div>
                            <div class="specialty-item">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="specialties" value="pedras-quentes" onchange="togglePriceInput(this)"> Terapia das Pedras Quentes
                                </label>
                                <input type="number" class="price-input" name="price_pedras-quentes" placeholder="Preço R$" min="1" max="5000" step="0.01" style="display: none;">
                            </div>
                            <div class="specialty-item">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="specialties" value="velas-quentes" onchange="togglePriceInput(this)"> Massagem com Velas Quentes
                                </label>
                                <input type="number" class="price-input" name="price_velas-quentes" placeholder="Preço R$" min="1" max="5000" step="0.01" style="display: none;">
                            </div>
                            <div class="specialty-item">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="specialties" value="esfoliacao" onchange="togglePriceInput(this)"> Massagem Relaxante com Esfoliação
                                </label>
                                <input type="number" class="price-input" name="price_esfoliacao" placeholder="Preço R$" min="1" max="5000" step="0.01" style="display: none;">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <button type="submit" class="quero-massagem-btn" style="width: 100%;">
                            <span class="btn-text">Cadastrar</span>
                            <span class="btn-loading" style="display: none;">Cadastrando...</span>
                        </button>
                    </div>
                    <p style="text-align: center; margin-top: 15px;">
                        <a href="#" id="showLoginForm" style="color: #47103C;">Já tenho conta - Fazer Login</a>
                    </p>
                </form>
            </div>

            <!-- Formulário de Esqueci Senha -->
            <div id="forgotPasswordFormDiv" style="display: none;">
                <h2>Recuperar Senha</h2>
                <form id="forgotPasswordForm">
                    <div class="form-group">
                        <label>E-mail:</label>
                        <input type="email" id="forgotEmail" required>
                    </div>
                    <div class="form-group">
                        <button type="submit" class="quero-massagem-btn" style="width: 100%;">
                            <span class="btn-text">Enviar Código</span>
                            <span class="btn-loading" style="display: none;">Enviando...</span>
                        </button>
                    </div>
                    <p style="text-align: center; margin-top: 20px;">
                        <a href="#" id="backToLogin" style="color: #47103C;">Voltar ao Login</a>
                    </p>
                </form>
            </div>

            <!-- Formulário de Reset Senha -->
            <div id="resetPasswordFormDiv" style="display: none;">
                <h2>Nova Senha</h2>
                <form id="resetPasswordForm">
                    <div class="form-group">
                        <label>Código de Verificação:</label>
                        <input type="text" id="resetToken" required maxlength="6" placeholder="Digite o código de 6 dígitos">
                    </div>
                    <div class="form-group">
                        <label>Nova Senha:</label>
                        <input type="password" id="newPassword" required minlength="6">
                    </div>
                    <div class="form-group">
                        <label>Confirmar Nova Senha:</label>
                        <input type="password" id="confirmNewPassword" required>
                    </div>
                    <div class="form-group">
                        <button type="submit" class="quero-massagem-btn" style="width: 100%;">
                            <span class="btn-text">Redefinir Senha</span>
                            <span class="btn-loading" style="display: none;">Redefinindo...</span>
                        </button>
                    </div>
                    <p style="text-align: center; margin-top: 20px;">
                        <a href="#" id="backToLoginFromReset" style="color: #47103C;">Voltar ao Login</a>
                    </p>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal Agendamento -->
    <div id="agendamentoModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="modal-close">&times;</span>
            <h2>Agendar Massagem</h2>
            
            <!-- Progress Indicator -->
            <div class="booking-progress">
                <div class="progress-step active">
                    <div class="progress-circle">1</div>
                    <div class="progress-label">Unidade</div>
                </div>
                <div class="progress-step">
                    <div class="progress-circle">2</div>
                    <div class="progress-label">Massagista</div>
                </div>
                <div class="progress-step">
                    <div class="progress-circle">3</div>
                    <div class="progress-label">Serviço</div>
                </div>
                <div class="progress-step">
                    <div class="progress-circle">4</div>
                    <div class="progress-label">Data/Hora</div>
                </div>
                <div class="progress-step">
                    <div class="progress-circle">5</div>
                    <div class="progress-label">Confirmar</div>
                </div>
            </div>
            
            <form id="agendamentoForm">
                <!-- Passo 1: Dados Pessoais -->
                <div class="booking-step active" id="step1">
                    <h3 style="color: #47103C; margin-bottom: 15px;">
                        <i class="fas fa-user"></i> Passo 1: Seus Dados
                    </h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Nome Completo:</label>
                            <input type="text" id="clientName" name="clientName" required>
                        </div>
                        <div class="form-group">
                            <label>Telefone:</label>
                            <input type="tel" id="clientPhone" name="phone" required>
                        </div>
                    </div>
                    <button type="button" onclick="validateStep1()" class="quero-massagem-btn continue-btn">
                        Continuar <i class="fas fa-arrow-right" style="margin-left: 8px;"></i>
                    </button>
                </div>
                
                <!-- Passo 2: Escolher Unidade -->
                <div class="booking-step" id="step2" style="display: none;">
                    <h3 style="color: #47103C; margin-bottom: 15px;">
                        <i class="fas fa-map-marker-alt"></i> Passo 2: Escolha a Unidade
                    </h3>
                    <div class="form-group">
                        <label>Unidade:</label>
                        <select id="unitSelect" required onchange="loadMassagistasByUnit()">
                            <option value="">Selecione uma unidade</option>
                            <option value="sp-perdizes">São Paulo - Perdizes</option>
                            <option value="sp-vila-clementino">São Paulo - Vila Clementino</option>
                            <option value="sp-ingleses">São Paulo - Ingleses [Matriz]</option>
                            <option value="sp-prudente">São Paulo - Prudente de Moraes</option>
                            <option value="rj-centro">Rio de Janeiro - Centro</option>
                            <option value="rj-copacabana">Rio de Janeiro - Copacabana</option>
                            <option value="bsb-sudoeste">Brasília - Sudoeste</option>
                            <option value="bsb-asa-sul">Brasília - Asa Sul</option>
                        </select>
                    </div>
                </div>
                
                <!-- Passo 3: Escolher Massagista -->
                <div class="booking-step" id="step3" style="display: none;">
                    <h3 style="color: #47103C; margin-bottom: 15px;">
                        <i class="fas fa-user"></i> Passo 3: Escolha a Massagista
                    </h3>
                    <div id="massagistaGrid" class="massagista-grid">
                        <!-- Massagistas serão carregadas dinamicamente -->
                    </div>
                </div>
                
                <!-- Passo 4: Escolher Serviço -->
                <div class="booking-step" id="step4" style="display: none;">
                    <h3 style="color: #47103C; margin-bottom: 15px;">
                        <i class="fas fa-spa"></i> Passo 4: Escolha o Serviço
                    </h3>
                    <div class="form-group">
                        <label>Tipo de Massagem:</label>
                        <select id="serviceSelect" required>
                            <option value="">Selecione o tipo</option>
                            <option value="shiatsu">Shiatsu</option>
                            <option value="quick">Quick Massage</option>
                            <option value="relaxante">Relaxante</option>
                            <option value="terapeutica">Terapêutica</option>
                            <option value="drenagem">Drenagem Linfática</option>
                            <option value="pedras">Pedras Quentes</option>
                        </select>
                    </div>
                </div>
                
                <!-- Passo 5: Calendário Inteligente -->
                <div class="booking-step" id="step5" style="display: none;">
                    <h3 style="color: #47103C; margin-bottom: 15px;">
                        <i class="fas fa-calendar-alt"></i> Passo 5: Escolha Data e Horário
                    </h3>
                    <div id="smartCalendar" class="smart-calendar">
                        <!-- Calendário será gerado dinamicamente -->
                    </div>
                </div>
                
                <!-- Resumo do Agendamento -->
                <div class="booking-step" id="step6" style="display: none;">
                    <h3 style="color: #47103C; margin-bottom: 15px;">
                        <i class="fas fa-check-circle"></i> Resumo do Agendamento
                    </h3>
                    <div id="bookingSummary" class="booking-summary">
                        <!-- Resumo será preenchido dinamicamente -->
                    </div>
                    
                    <div class="form-group" style="margin-top: 25px;">
                        <label>Observações (opcional):</label>
                        <textarea name="notes" rows="3" placeholder="Digite aqui suas observações..."></textarea>
                    </div>
                    
                    <div class="form-group" style="margin-top: 25px;">
                        <button type="submit" class="quero-massagem-btn continue-btn">
                            <i class="fas fa-check" style="margin-right: 8px;"></i> Confirmar Agendamento
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/swiper@8/swiper-bundle.min.js"></script>
    <script>
        // Inicializar Swiper
        const swiper = new Swiper('.heroSwiper', {
            loop: true,
            autoplay: {
                delay: 5000,
                disableOnInteraction: false,
            },
            effect: 'fade',
            fadeEffect: {
                crossFade: true
            },
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
        });
        
        // Modal functionality
        document.getElementById('loginBtn').onclick = function() {
            document.getElementById('loginModal').style.display = 'block';
        }
        
        document.getElementById('agendarBtn').onclick = function() {
            document.getElementById('agendamentoModal').style.display = 'block';
        }
        
        // Close modals
        document.querySelectorAll('.modal-close').forEach(function(closeBtn) {
            closeBtn.onclick = function() {
                this.closest('.modal').style.display = 'none';
            }
        });
        
        // Close modal when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }
        
        // Toggle between login and register forms
        document.getElementById('showRegisterForm').onclick = function(e) {
            e.preventDefault();
            document.getElementById('loginFormDiv').style.display = 'none';
            document.getElementById('registerFormDiv').style.display = 'block';
        }
        
        document.getElementById('showLoginForm').onclick = function(e) {
            e.preventDefault();
            document.getElementById('loginFormDiv').style.display = 'block';
            document.getElementById('registerFormDiv').style.display = 'none';
            document.getElementById('forgotPasswordFormDiv').style.display = 'none';
            document.getElementById('resetPasswordFormDiv').style.display = 'none';
        }

        // Forgot Password Form Navigation
        document.getElementById('showForgotPassword').onclick = function(e) {
            e.preventDefault();
            document.getElementById('loginFormDiv').style.display = 'none';
            document.getElementById('registerFormDiv').style.display = 'none';
            document.getElementById('forgotPasswordFormDiv').style.display = 'block';
            document.getElementById('resetPasswordFormDiv').style.display = 'none';
        }

        document.getElementById('backToLogin').onclick = function(e) {
            e.preventDefault();
            document.getElementById('loginFormDiv').style.display = 'block';
            document.getElementById('registerFormDiv').style.display = 'none';
            document.getElementById('forgotPasswordFormDiv').style.display = 'none';
            document.getElementById('resetPasswordFormDiv').style.display = 'none';
        }

        document.getElementById('backToLoginFromReset').onclick = function(e) {
            e.preventDefault();
            document.getElementById('loginFormDiv').style.display = 'block';
            document.getElementById('registerFormDiv').style.display = 'none';
            document.getElementById('forgotPasswordFormDiv').style.display = 'none';
            document.getElementById('resetPasswordFormDiv').style.display = 'none';
        }
        
        // Máscara para CPF e telefone
        document.getElementById('registerCpf').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
            e.target.value = value;
        });
        
        document.getElementById('registerPhone').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            value = value.replace(/(\d{2})(\d)/, '($1) $2');
            value = value.replace(/(\d{5})(\d)/, '$1-$2');
            e.target.value = value;
        });

        // Toggle price input visibility based on checkbox state
        function togglePriceInput(checkbox) {
            const parentDiv = checkbox.closest('.specialty-item');
            const priceInput = parentDiv.querySelector('.price-input');
            
            if (checkbox.checked) {
                priceInput.style.display = 'block';
                priceInput.required = true;
            } else {
                priceInput.style.display = 'none';
                priceInput.required = false;
                priceInput.value = '';
            }
        }

        // Booking System Variables
        let selectedUnit = '';
        let selectedMassagista = '';
        let selectedService = '';
        let selectedDate = '';
        let selectedTime = '';
        let currentStep = 1;
        
        // Validate step 1 (personal data)
        function validateStep1() {
            const clientName = document.getElementById('clientName').value.trim();
            const clientPhone = document.getElementById('clientPhone').value.trim();
            
            if (!clientName || !clientPhone) {
                alert('Por favor, preencha seu nome completo e telefone.');
                return;
            }
            
            if (clientName.length < 2) {
                alert('Por favor, digite um nome válido.');
                return;
            }
            
            if (clientPhone.length < 10) {
                alert('Por favor, digite um telefone válido.');
                return;
            }
            
            // Move to step 2 (unit selection)
            showStep(2);
        }
        
        // No mock data - using only real registered massagistas
        
        // Load massagistas by selected unit
        async function loadMassagistasByUnit() {
            const unitSelect = document.getElementById('unitSelect');
            const grid = document.getElementById('massagistaGrid');
            
            if (!unitSelect || !grid) return;
            
            selectedUnit = unitSelect.value;
            if (!selectedUnit) {
                grid.innerHTML = '<p>Selecione uma unidade para ver as massagistas disponíveis.</p>';
                return;
            }

            try {
                // Call API to get massagistas by unit
                const response = await fetch(`http://localhost:10000/api/massagista/by-unit/${selectedUnit}`);
                
                if (response.ok) {
                    const unitMassagistas = await response.json();
                    
                    if (unitMassagistas.length === 0) {
                        grid.innerHTML = '<p>Nenhuma massagista disponível nesta unidade no momento.</p>';
                        return;
                    }
                    
                    grid.innerHTML = unitMassagistas.map((massagista, index) => `
                        <div class="massagista-card" onclick="selectMassagistaById(${index})">
                            <div class="avatar-placeholder">${massagista.name.charAt(0)}</div>
                            <h4>${massagista.name}</h4>
                            <p>${massagista.specialties.join(', ')}</p>
                            <span class="status ${massagista.is_available ? 'online' : 'offline'}">
                                ${massagista.is_available ? 'Disponível' : 'Ocupada'}
                            </span>
                        </div>
                    `).join('');
                    
                    // Store massagistas data globally for selection
                    window.currentMassagistas = unitMassagistas;
                } else {
                    console.error('Erro na resposta da API:', response.status);
                    grid.innerHTML = '<p>Erro ao carregar massagistas. Tente novamente.</p>';
                }
                
                // Show step 3 (massagista selection)
                showStep(3);
            } catch (error) {
                console.error('Erro ao carregar massagistas da unidade:', error);
                grid.innerHTML = '<p>Erro ao carregar massagistas. Tente novamente.</p>';
            }
        }
        
        // Select massagista by index
        function selectMassagistaById(index) {
            const massagista = window.currentMassagistas[index];
            selectedMassagista = { 
                id: massagista.id, 
                name: massagista.name, 
                specialties: massagista.specialties 
            };
            
            // Update visual selection
            document.querySelectorAll('.massagista-card').forEach(card => card.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            
            // Filter services based on massagista specialties
            filterServicesForMassagista(massagista.specialties);
            
            // Show step 4 (service selection)
            setTimeout(() => showStep(4), 500);
        }
        
        // Legacy function for backward compatibility
        function selectMassagista(id, name, specialties) {
            selectedMassagista = { id, name, specialties };
            
            // Update visual selection
            document.querySelectorAll('.massagista-card').forEach(card => card.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            
            // Filter services based on massagista specialties
            filterServicesForMassagista(specialties);
            
            // Show step 4 (service selection)
            setTimeout(() => showStep(4), 500);
        }
        
        // Filter services based on massagista specialties
        function filterServicesForMassagista(specialties) {
            const serviceSelect = document.getElementById('serviceSelect');
            
            // Map of service values to display names
            const serviceMap = {
                'shiatsu': 'Shiatsu',
                'quick': 'Quick Massage',
                'relaxante': 'Relaxante',
                'terapeutica': 'Terapêutica',
                'drenagem': 'Drenagem Linfática',
                'ventosaterapia': 'Ventosaterapia',
                'redutora': 'Massagem Redutora',
                'pedras-quentes': 'Terapia das Pedras Quentes',
                'velas-quentes': 'Massagem com Velas Quentes',
                'esfoliacao': 'Massagem Relaxante com Esfoliação'
            };
            
            // Clear current options
            serviceSelect.innerHTML = '<option value="">Selecione o tipo</option>';
            
            // Add only available services
            specialties.forEach(specialty => {
                if (serviceMap[specialty]) {
                    const option = document.createElement('option');
                    option.value = specialty;
                    option.textContent = serviceMap[specialty];
                    serviceSelect.appendChild(option);
                }
            });
            
            console.log(`Serviços filtrados para massagista: ${specialties.join(', ')}`);
        }
        
        // Handle service selection
        document.getElementById('serviceSelect').onchange = function() {
            selectedService = this.value;
            if (selectedService) {
                setTimeout(() => showStep(5), 500);
                generateSmartCalendar();
            }
        }
        
        // Generate smart calendar
        async function generateSmartCalendar() {
            const calendar = document.getElementById('smartCalendar');
            const today = new Date();
            const currentMonth = today.getMonth();
            const currentYear = today.getFullYear();
            
            // Load massagista availability for current month
            const massagistaAvailability = await loadMassagistaAvailability();
            
            calendar.innerHTML = `
                <div class="calendar-section">
                    <div class="calendar-header">
                        <h4 style="margin: 0; color: #47103C;">Selecione uma Data - ${getMonthName(currentMonth)} ${currentYear}</h4>
                    </div>
                    <div class="calendar-grid">
                        ${generateMonthCalendar(currentYear, currentMonth, massagistaAvailability)}
                    </div>
                </div>
                <div class="calendar-section">
                    <h4 style="margin-bottom: 10px; color: #47103C;">Horários Disponíveis</h4>
                    <div id="timeSlots" class="time-slots">
                        <div class="time-slot unavailable">Selecione uma data</div>
                    </div>
                </div>
            `;
        }
        
        // Get month name in Portuguese
        function getMonthName(monthIndex) {
            const months = [
                'Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
                'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'
            ];
            return months[monthIndex];
        }
        
        // Load massagista availability
        async function loadMassagistaAvailability() {
            if (!selectedMassagista) return {};
            
            try {
                const currentDate = new Date();
                const year = currentDate.getFullYear();
                const month = currentDate.getMonth() + 1;
                
                const response = await fetch(`http://localhost:10000/api/massagista/${selectedMassagista.id}/availability/month/${year}/${month}`);
                if (response.ok) {
                    return await response.json();
                }
            } catch (error) {
                console.error('Erro ao carregar disponibilidade:', error);
            }
            return {};
        }
        
        // Generate complete month calendar
        function generateMonthCalendar(year, month, availability = {}) {
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const today = new Date();
            
            let html = '';
            
            // Add day headers
            html += `
                <div class="calendar-weekdays">
                    <div class="weekday">Dom</div>
                    <div class="weekday">Seg</div>
                    <div class="weekday">Ter</div>
                    <div class="weekday">Qua</div>
                    <div class="weekday">Qui</div>
                    <div class="weekday">Sex</div>
                    <div class="weekday">Sáb</div>
                </div>
            `;
            
            html += '<div class="calendar-days">';
            
            // Add empty cells for days before month starts
            for (let i = 0; i < firstDay.getDay(); i++) {
                html += '<div class="calendar-day empty"></div>';
            }
            
            // Add days of the month
            for (let day = 1; day <= lastDay.getDate(); day++) {
                const currentDate = new Date(year, month, day);
                const dateStr = currentDate.toISOString().split('T')[0];
                const dayAvailability = availability[dateStr];
                
                // Check if day is available based on massagista's settings
                const isAvailable = dayAvailability && 
                                  dayAvailability.status === 'available' && 
                                  dayAvailability.time_slots && 
                                  dayAvailability.time_slots.length > 0;
                
                // Don't allow past dates
                const isPast = currentDate < today.setHours(0,0,0,0);
                const canSelect = isAvailable && !isPast;
                
                let classes = 'calendar-day';
                if (isPast) classes += ' past';
                else if (isAvailable) classes += ' available';
                else classes += ' unavailable';
                
                html += `
                    <div class="${classes}" 
                         ${canSelect ? `onclick="selectDate('${dateStr}')"` : ''}
                         data-date="${dateStr}"
                         ${canSelect ? `style="cursor: pointer;"` : `style="cursor: not-allowed;"`}>
                        ${day}
                    </div>
                `;
            }
            
            html += '</div>';
            return html;
        }
        
        // Select date
        async function selectDate(dateStr) {
            selectedDate = dateStr;
            
            // Update visual selection
            document.querySelectorAll('.calendar-day').forEach(day => day.classList.remove('selected'));
            document.querySelector(`[data-date="${dateStr}"]`).classList.add('selected');
            
            // Generate time slots
            await generateTimeSlots(dateStr);
        }
        
        // Generate time slots
        async function generateTimeSlots(dateStr) {
            const timeSlots = document.getElementById('timeSlots');
            
            if (!selectedMassagista || !dateStr) {
                timeSlots.innerHTML = '<div class="time-slot unavailable">Selecione uma data</div>';
                return;
            }
            
            try {
                // Get availability for specific day
                const response = await fetch(`http://localhost:10000/api/massagista/${selectedMassagista.id}/availability/day/${dateStr}`);
                
                if (response.ok) {
                    const dayAvailability = await response.json();
                    
                    if (dayAvailability && dayAvailability.time_slots && dayAvailability.time_slots.length > 0) {
                        timeSlots.innerHTML = dayAvailability.time_slots.map(time => `
                            <div class="time-slot available" onclick="selectTime('${time}')">
                                ${time}
                            </div>
                        `).join('');
                    } else {
                        timeSlots.innerHTML = '<div class="time-slot unavailable">Nenhum horário disponível</div>';
                    }
                } else {
                    timeSlots.innerHTML = '<div class="time-slot unavailable">Nenhum horário disponível</div>';
                }
            } catch (error) {
                console.error('Erro ao carregar horários:', error);
                timeSlots.innerHTML = '<div class="time-slot unavailable">Erro ao carregar horários</div>';
            }
        }
        
        // Select time
        function selectTime(time) {
            selectedTime = time;
            
            // Update visual selection
            document.querySelectorAll('.time-slot').forEach(slot => slot.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            
            // Show step 6 (summary)
            setTimeout(() => showStep(6), 500);
            generateBookingSummary();
        }
        
        // Generate booking summary
        function generateBookingSummary() {
            const unitName = document.getElementById('unitSelect').selectedOptions[0].text;
            const serviceName = document.getElementById('serviceSelect').selectedOptions[0].text;
            const date = new Date(selectedDate).toLocaleDateString('pt-BR');
            
            const summary = document.getElementById('bookingSummary');
            summary.innerHTML = `
                <div style="background: #f8f9fa; padding: 20px; border-radius: 8px;">
                    <p><strong>Unidade:</strong> ${unitName}</p>
                    <p><strong>Massagista:</strong> ${selectedMassagista.name}</p>
                    <p><strong>Serviço:</strong> ${serviceName}</p>
                    <p><strong>Data:</strong> ${date}</p>
                    <p><strong>Horário:</strong> ${selectedTime}</p>
                </div>
            `;
        }
        
        // Show specific step
        function showStep(stepNum) {
            // Hide all steps
            for (let i = 1; i <= 5; i++) {
                document.getElementById(`step${i}`).style.display = 'none';
                document.getElementById(`step${i}`).classList.remove('active');
            }
            
            // Show current step
            document.getElementById(`step${stepNum}`).style.display = 'block';
            document.getElementById(`step${stepNum}`).classList.add('active');
            
            // Update progress
            updateProgress(stepNum);
            currentStep = stepNum;
        }
        
        // Update progress indicators
        function updateProgress(stepNum) {
            const steps = document.querySelectorAll('.progress-step');
            steps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index + 1 < stepNum) {
                    step.classList.add('completed');
                } else if (index + 1 === stepNum) {
                    step.classList.add('active');
                }
            });
        }

        // Form submissions
        document.getElementById('loginForm').onsubmit = async function(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            // Simular loading
            const btnText = document.querySelector('#loginForm .btn-text');
            const btnLoading = document.querySelector('#loginForm .btn-loading');
            btnText.style.display = 'none';
            btnLoading.style.display = 'inline';
            
            try {
                // Usar API real
                const api = new APIService();
                const response = await api.login({ email, password });
                
                if (response && response.access_token) {
                    // Login bem-sucedido
                    localStorage.setItem('espacoviv_token', response.access_token);
                    localStorage.setItem('espacoviv_current_user', JSON.stringify(response.user));
                    
                    // Redirecionar para área do profissional
                    alert('Login realizado com sucesso! Redirecionando para seus agendamentos...');
                    window.location.href = 'dashboard.html';
                } else {
                    throw new Error('Resposta inválida da API');
                }
            } catch (error) {
                console.error('Erro no login:', error);
                alert('E-mail ou senha incorretos!');
                btnText.style.display = 'inline';
                btnLoading.style.display = 'none';
            }
        }
        
        document.getElementById('registerForm').onsubmit = async function(e) {
            e.preventDefault();
            
            const name = document.getElementById('registerName').value;
            const cpf = document.getElementById('registerCpf').value;
            const email = document.getElementById('registerEmail').value;
            const phone = document.getElementById('registerPhone').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const unit = document.getElementById('registerUnit').value;
            const specialties = Array.from(document.querySelectorAll('input[name="specialties"]:checked')).map(cb => cb.value);
            
            // Collect specialty prices
            const specialtyPrices = [];
            specialties.forEach(specialty => {
                const priceInput = document.querySelector(`input[name="price_${specialty}"]`);
                if (priceInput && priceInput.value) {
                    specialtyPrices.push({
                        specialty: specialty,
                        price: parseFloat(priceInput.value)
                    });
                }
            });
            
            // Validações
            if (password !== confirmPassword) {
                alert('As senhas não coincidem!');
                return;
            }
            
            if (specialties.length === 0) {
                alert('Selecione pelo menos uma especialidade!');
                return;
            }
            
            if (specialtyPrices.length !== specialties.length) {
                alert('Informe o preço para todas as especialidades selecionadas!');
                return;
            }
            
            // Validate prices
            for (let sp of specialtyPrices) {
                if (sp.price <= 0 || sp.price > 5000) {
                    alert(`Preço para ${sp.specialty} deve estar entre R$ 1 e R$ 5.000!`);
                    return;
                }
            }
            
            // Simular loading
            const btnText = document.querySelector('#registerForm .btn-text');
            const btnLoading = document.querySelector('#registerForm .btn-loading');
            btnText.style.display = 'none';
            btnLoading.style.display = 'inline';
            
            try {
                // Usar API real para registro
                const api = new APIService();
                
                // Preparar dados para API
                const userData = {
                    name,
                    email,
                    password,
                    cpf: cpf.replace(/\D/g, ''), // Remove formatação
                    phone: phone.replace(/\D/g, ''), // Remove formatação
                    unit_preference: unit,
                    specialties,
                    specialty_prices: specialtyPrices,
                    birth_date: "1990-01-01", // Valor padrão
                    gender: "M", // Valor padrão
                    experience_years: 1 // Valor padrão
                };
                
                // Verificar se a senha atende aos critérios
                const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
                if (!passwordRegex.test(password)) {
                    alert('A senha deve conter:\n- Mínimo 8 caracteres\n- Uma letra maiúscula\n- Uma letra minúscula\n- Um número\n- Um caractere especial');
                    return;
                }
                
                console.log('Enviando dados para API:', userData);
                const response = await api.register(userData);
                console.log('Resposta da API:', response);
                
                if (response && (response.message || response.user_id)) {
                    alert('Cadastro realizado com sucesso! Agora você pode fazer login.');
                    
                    // Voltar para o formulário de login
                    document.getElementById('showLoginForm').click();
                    document.getElementById('registerForm').reset();
                } else {
                    throw new Error('Resposta inválida da API: ' + JSON.stringify(response));
                }
                
            } catch (error) {
                console.error('Erro no registro:', error);
                
                let errorMessage = 'Erro no cadastro. Tente novamente.';
                
                if (error.detail) {
                    if (typeof error.detail === 'string') {
                        errorMessage = error.detail;
                    } else if (error.detail.message) {
                        errorMessage = error.detail.message;
                        if (error.detail.errors) {
                            errorMessage += '\n' + error.detail.errors.join('\n');
                        }
                    }
                } else if (error.message) {
                    errorMessage = error.message;
                }
                
                alert(errorMessage);
            }
            
            btnText.style.display = 'inline';
            btnLoading.style.display = 'none';
        }

        // Forgot Password Form Handler
        document.getElementById('forgotPasswordForm').onsubmit = async function(e) {
            e.preventDefault();
            const email = document.getElementById('forgotEmail').value;
            
            const btnText = document.querySelector('#forgotPasswordForm .btn-text');
            const btnLoading = document.querySelector('#forgotPasswordForm .btn-loading');
            btnText.style.display = 'none';
            btnLoading.style.display = 'inline';
            
            try {
                const api = new APIService();
                const response = await api.forgotPassword({ email });
                
                alert('Se o email existir em nosso sistema, você receberá um código de verificação.');
                
                // Switch to reset password form
                document.getElementById('forgotPasswordFormDiv').style.display = 'none';
                document.getElementById('resetPasswordFormDiv').style.display = 'block';
                
            } catch (error) {
                console.error('Erro ao solicitar reset:', error);
                alert('Erro ao enviar solicitação. Tente novamente.');
            }
            
            btnText.style.display = 'inline';
            btnLoading.style.display = 'none';
        }

        // Reset Password Form Handler
        document.getElementById('resetPasswordForm').onsubmit = async function(e) {
            e.preventDefault();
            const token = document.getElementById('resetToken').value;
            const password = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmNewPassword').value;
            
            if (password !== confirmPassword) {
                alert('As senhas não coincidem!');
                return;
            }
            
            if (password.length < 6) {
                alert('A senha deve ter pelo menos 6 caracteres!');
                return;
            }
            
            const btnText = document.querySelector('#resetPasswordForm .btn-text');
            const btnLoading = document.querySelector('#resetPasswordForm .btn-loading');
            btnText.style.display = 'none';
            btnLoading.style.display = 'inline';
            
            try {
                const api = new APIService();
                const response = await api.resetPassword({ token, password });
                
                alert('Senha redefinida com sucesso! Faça login com sua nova senha.');
                
                // Clear form and go back to login
                document.getElementById('resetPasswordForm').reset();
                document.getElementById('backToLoginFromReset').click();
                
            } catch (error) {
                console.error('Erro ao redefinir senha:', error);
                alert('Código inválido ou expirado. Tente novamente.');
            }
            
            btnText.style.display = 'inline';
            btnLoading.style.display = 'none';
        }
        
        // Initialize booking form
        document.addEventListener('DOMContentLoaded', function() {
            loadMassagistas();
            const dataSelect = document.getElementById('dataSelect');
            if (dataSelect) {
                dataSelect.min = new Date().toISOString().split('T')[0];
            }
        });
        
        async function loadMassagistas() {
            const select = document.getElementById('massagistaSelect');
            if (!select) return; // Verificar se elemento existe
            
            try {
                // Usar nova API se disponível
                if (window.app && window.app.api) {
                    const units = await window.app.api.getUnits();
                    const defaultUnit = units.length > 0 ? units[0].code : 'sp-perdizes';
                    const massagistas = await window.app.api.request(`/massagista/by-unit/${defaultUnit}`);
                    
                    select.innerHTML = '<option value="">Selecione uma massagista</option>';
                    massagistas.forEach(massagista => {
                        const option = document.createElement('option');
                        option.value = massagista.id;
                        option.textContent = `${massagista.name} - ${massagista.specialties.join(', ')}`;
                        select.appendChild(option);
                    });
                } else {
                    // Fallback para dados locais
                    const users = JSON.parse(localStorage.getItem('espacoviv_users') || '[]');
                    const massagistas = users.filter(user => user.isOnline);
                    
                    select.innerHTML = '<option value="">Selecione uma massagista</option>';
                    massagistas.forEach(massagista => {
                        const option = document.createElement('option');
                        option.value = massagista.id;
                        option.textContent = massagista.name;
                        select.appendChild(option);
                    });
                }
            } catch (error) {
                console.error('Erro ao carregar massagistas:', error);
                select.innerHTML = '<option value="">Erro ao carregar massagistas</option>';
            }
        }
        
        function getUnitName(unit) {
            const units = {
                // São Paulo
                'sp': 'São Paulo - Perdizes',
                'sp-ingleses': 'São Paulo - Ingleses [Matriz]',
                'sp-perdizes': 'São Paulo - Perdizes', 
                'sp-vila-clementino': 'São Paulo - Vila Clementino',
                'sp-prudente': 'São Paulo - Prudente de Moraes',
                
                // Rio de Janeiro
                'rj': 'Rio de Janeiro - Centro',
                'rj-centro': 'Rio de Janeiro - Centro',
                'rj-copacabana': 'Rio de Janeiro - Copacabana',
                
                // Brasília
                'bsb': 'Brasília - SHS',
                'bsb-sudoeste': 'Brasília - Sudoeste',
                'bsb-asa-sul': 'Brasília - Asa Sul (Galeria Hotel Nacional)'
            };
            return units[unit] || 'Unidade não definida';
        }
        
        function updateAvailableTimes() {
            const massagistaId = document.getElementById('massagistaSelect').value;
            const selectedDate = document.getElementById('dataSelect').value;
            const horarioSelect = document.getElementById('horarioSelect');
            const statusDiv = document.getElementById('availabilityStatus');
            
            if (!massagistaId || !selectedDate) {
                horarioSelect.innerHTML = '<option value="">Primeiro selecione massagista e data</option>';
                statusDiv.innerHTML = 'Selecione massagista e data para ver disponibilidade';
                statusDiv.style.background = '#f8f9fa';
                statusDiv.style.color = '#666';
                return;
            }
            
            const users = JSON.parse(localStorage.getItem('espacoviv_users') || '[]');
            const massagista = users.find(u => u.id === massagistaId);
            
            if (!massagista) {
                horarioSelect.innerHTML = '<option value="">Massagista não encontrada</option>';
                statusDiv.innerHTML = 'Massagista não encontrada';
                statusDiv.style.background = '#f8d7da';
                statusDiv.style.color = '#721c24';
                return;
            }
            
            const dateKey = selectedDate;
            const availability = massagista.availability && massagista.availability[dateKey];
            
            if (!availability || availability.status !== 'available') {
                horarioSelect.innerHTML = '<option value="">Massagista não disponível nesta data</option>';
                statusDiv.innerHTML = 'Massagista não disponível nesta data';
                statusDiv.style.background = '#f8d7da';
                statusDiv.style.color = '#721c24';
                return;
            }
            
            // Get existing appointments for this date
            const appointments = JSON.parse(localStorage.getItem('espacoviv_appointments') || '[]');
            const bookedTimes = appointments
                .filter(apt => apt.massagistId === massagistaId && apt.date === dateKey && apt.status !== 'cancelled')
                .map(apt => apt.time);
            
            // Filter available time slots
            const availableSlots = availability.timeSlots.filter(slot => !bookedTimes.includes(slot));
            
            horarioSelect.innerHTML = '<option value="">Selecione um horário</option>';
            
            if (availableSlots.length === 0) {
                horarioSelect.innerHTML = '<option value="">Nenhum horário disponível</option>';
                statusDiv.innerHTML = 'Todos os horários já estão ocupados nesta data';
                statusDiv.style.background = '#fff3cd';
                statusDiv.style.color = '#856404';
            } else {
                availableSlots.forEach(slot => {
                    const option = document.createElement('option');
                    option.value = slot;
                    option.textContent = slot;
                    horarioSelect.appendChild(option);
                });
                
                statusDiv.innerHTML = `${availableSlots.length} horário(s) disponível(eis)`;
                statusDiv.style.background = '#d4edda';
                statusDiv.style.color = '#155724';
            }
        }
        
        document.getElementById('agendamentoForm').onsubmit = async function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            
            const appointment = {
                id: Date.now().toString(),
                clientName: formData.get('clientName'),
                phone: formData.get('phone'),
                unit: selectedUnit,
                service: selectedService,
                massagistId: selectedMassagista ? selectedMassagista.id : null,
                date: selectedDate,
                time: selectedTime,
                notes: formData.get('notes') || '',
                status: 'confirmed',
                createdAt: new Date().toISOString()
            };
            
            // Validate required fields
            if (!appointment.clientName || !appointment.phone || !appointment.unit || 
                !appointment.service || !appointment.massagistId || !appointment.date || !appointment.time) {
                alert('Por favor, preencha todos os campos obrigatórios.');
                return;
            }
            
            // Save appointment to backend
            try {
                const response = await fetch('http://localhost:10000/api/bookings', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        massagista_id: appointment.massagistId,
                        client_name: appointment.clientName,
                        client_phone: appointment.phone,
                        unit_code: appointment.unit,
                        service: appointment.service,
                        appointment_date: appointment.date,
                        appointment_time: appointment.time,
                        notes: appointment.notes || ''
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    alert('Agendamento confirmado! Você receberá uma confirmação em breve.');
                } else {
                    throw new Error('Erro ao criar agendamento');
                }
            } catch (error) {
                console.error('Erro ao salvar agendamento:', error);
                // Fallback to localStorage if API fails
                const appointments = JSON.parse(localStorage.getItem('espacoviv_appointments') || '[]');
                appointments.push(appointment);
                localStorage.setItem('espacoviv_appointments', JSON.stringify(appointments));
                alert('Agendamento salvo localmente. Entre em contato para confirmar.');
            }
            document.getElementById('agendamentoModal').style.display = 'none';
            e.target.reset();
            
            // Reset form state (commenting out elements that don't exist in current modal)
            // These were from an older version of the modal
            // document.getElementById('horarioSelect').innerHTML = '<option value="">Primeiro selecione massagista e data</option>';
            // document.getElementById('availabilityStatus').innerHTML = 'Selecione massagista e data para ver disponibilidade';
            // document.getElementById('availabilityStatus').style.background = '#f8f9fa';
            // document.getElementById('availabilityStatus').style.color = '#666';
        }
        
        // Funções de gerenciamento do usuário logado
        function showUserMenu(user) {
            document.getElementById('loginBtn').style.display = 'none';
            document.getElementById('userMenu').style.display = 'block';
            document.getElementById('userName').textContent = user.name.toUpperCase();
            document.getElementById('userLocation').textContent = getUnitName(user.unit_preference);
        }
        
        function hideUserMenu() {
            document.getElementById('loginBtn').style.display = 'block';
            document.getElementById('userMenu').style.display = 'none';
        }
        
        // Verificar se usuário está logado ao carregar a página
        document.addEventListener('DOMContentLoaded', function() {
            const currentUser = localStorage.getItem('espacoviv_current_user');
            if (currentUser) {
                const user = JSON.parse(currentUser);
                showUserMenu(user);
            }
        });
        
        // Toggle dropdown do menu do usuário
        document.addEventListener('click', function(e) {
            const userInfo = document.querySelector('.user-info-header');
            const dropdown = document.querySelector('.user-dropdown');
            
            if (userInfo && userInfo.contains(e.target)) {
                dropdown.classList.toggle('show');
            } else {
                dropdown.classList.remove('show');
            }
        });
        
        // Logout
        document.getElementById('logoutBtn').addEventListener('click', function(e) {
            e.preventDefault();
            localStorage.removeItem('espacoviv_current_user');
            hideUserMenu();
            alert('Você foi deslogado com sucesso!');
        });
        
        // Smooth scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const href = this.getAttribute('href');
                if (href && href.length > 1) {
                    const target = document.querySelector(href);
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                }
            });
        });


        // Initialize app with API integration
        // window.app = new EspacoVivApp();

        // Fix missing images with fallback
        document.addEventListener('DOMContentLoaded', function() {
            // Add error handlers to all existing images
            const images = document.querySelectorAll('img');
            images.forEach(img => {
                if (!img.onerror) {
                    img.onerror = function() {
                        this.src = 'https://via.placeholder.com/400x300/6b8e23/ffffff?text=Espaço+VIV';
                    };
                }
            });
        });

    </script>

    <!-- Include main.js with API integration -->
    <script src="../js/main.js"></script>
</body>
</html>